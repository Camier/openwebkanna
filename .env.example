# ==============================================================================
# OpenWebUI with RAG - Environment Configuration Example
# ==============================================================================
# Copy this file to .env and modify the values as needed for your deployment.
# This configuration connects OpenWebUI to CLIProxyAPI running in Docker.

# ==============================================================================
# Authentication Settings
# ==============================================================================
# Set to true for multi-user deployments with authentication
# Set to false for single-user deployments without authentication
WEBUI_AUTH=false

# Display name for the OpenWebUI instance
WEBUI_NAME=OpenWebUI

# Secret key for session management (generate a strong random string in production)
WEBUI_SECRET_KEY=change-this-to-a-random-secret-key

# Port for OpenWebUI web interface
WEBUI_PORT=3000

# OpenWebUI container image (pin for reproducible deployments)
OPENWEBUI_IMAGE=ghcr.io/open-webui/open-webui:v0.7.2

# Disable Ollama by default for CLIProxyAPI-first deployments.
ENABLE_OLLAMA_API=false
OLLAMA_BASE_URL=http://host.docker.internal:11434

# ==============================================================================
# CLIProxyAPI Upstream Connection (Default)
# ==============================================================================
# Base URL for CLIProxyAPI (OpenAI-compatible endpoint)
# Use Docker service DNS so OpenWebUI does not depend on host-gateway routing
OPENAI_API_BASE_URL=http://cliproxyapi:8317/v1

# API key accepted by local CLIProxyAPI
OPENAI_API_KEY=layra-cliproxyapi-key

# Optional semicolon-separated fallback endpoints and keys (same order).
# Keep local CLIProxyAPI as the single source unless you intentionally add fallbacks.
OPENAI_API_BASE_URLS=http://cliproxyapi:8317/v1
OPENAI_API_KEYS=layra-cliproxyapi-key

# Default model name (optional - leave empty to auto-detect from CLIProxyAPI)
OPENAI_API_MODEL_NAME=

# Optional explicit chat model for scripts (e.g. test-rag.sh)
# If empty, scripts auto-detect first model from /v1/models
RAG_CHAT_MODEL=

# ==============================================================================
# CLIProxyAPI Service Settings
# ==============================================================================
# Enable first-class lifecycle management for CLIProxyAPI.
# This repository expects CLIProxyAPI to be available by default.
CLIPROXYAPI_ENABLED=true
CLIPROXYAPI_DOCKER_MANAGED=true
CLIPROXYAPI_IMAGE=eceasy/cli-proxy-api:latest

# CLIProxyAPI executable and startup options.
CLIPROXYAPI_CMD=./bin/cliproxyapi
CLIPROXYAPI_CONFIG=./cliproxyapi/config.yaml
CLIPROXYAPI_CONFIG_FLAG=--config
CLIPROXYAPI_SETUP_SCRIPT=./setup-cliproxyapi.sh
CLIPROXYAPI_INSTALL_ON_START=true
CLIPROXYAPI_VERSION=latest
CLIPROXYAPI_EXTRA_ARGS=

# CLIProxyAPI network and health defaults.
CLIPROXYAPI_BASE_URL=http://127.0.0.1:8317
CLIPROXYAPI_BIND_HOST=0.0.0.0
CLIPROXYAPI_PORT=8317
CLIPROXYAPI_HEALTH_PATH=/
CLIPROXYAPI_MODELS_PATH=/v1/models
CLIPROXYAPI_CHAT_PATH=/v1/chat/completions
CLIPROXYAPI_HEALTH_RETRIES=45
CLIPROXYAPI_STARTUP_WAIT_SECONDS=2
CLIPROXYAPI_STOP_TIMEOUT=20
CLIPROXYAPI_FORCE_KILL=true
CLIPROXYAPI_CHECK_TIMEOUT=15

# API key used by check-cliproxyapi.sh for authenticated /v1/models checks.
# Set this to the same value as OPENAI_API_KEY and an entry in cliproxyapi/config.yaml api-keys.
CLIPROXYAPI_API_KEY=layra-cliproxyapi-key

# Auto-generation of cliproxyapi/config.yaml.
# OAuth mode exposes model aliases for antigravity/codex/qwen/kimi credentials.
CLIPROXYAPI_CONFIG_AUTOGEN=true
CLIPROXYAPI_PROVIDER_MODE=oauth
CLIPROXYAPI_UPSTREAM_NAME=
CLIPROXYAPI_UPSTREAM_BASE_URL=
CLIPROXYAPI_UPSTREAM_API_KEY=
CLIPROXYAPI_UPSTREAM_MODEL=
CLIPROXYAPI_UPSTREAM_MODEL_ALIAS=
CLIPROXYAPI_OAUTH_ANTIGRAVITY_MODEL=gemini-3-pro-high
CLIPROXYAPI_OAUTH_ANTIGRAVITY_ALIAS=antigravity-oauth
CLIPROXYAPI_OAUTH_CODEX_MODEL=gpt-5-codex
CLIPROXYAPI_OAUTH_CODEX_ALIAS=openai-codex
CLIPROXYAPI_OAUTH_QWEN_MODEL=qwen3-coder-plus
CLIPROXYAPI_OAUTH_QWEN_ALIAS=qwen-cli
CLIPROXYAPI_OAUTH_KIMI_MODEL=kimi-k2.5
CLIPROXYAPI_OAUTH_KIMI_ALIAS=kimi-cli
CLIPROXYAPI_DISABLE_MANAGEMENT_PANEL=true
CLIPROXYAPI_CHECK_CHAT_COMPLETION=true

# CLIProxyAPI runtime artifacts.
CLIPROXYAPI_LOG_FILE=logs/cliproxyapi.log
CLIPROXYAPI_PID_FILE=.cliproxyapi.pid

# OAuth setup helpers (used by configure-cliproxyapi-oauth.sh)
CLIPROXYAPI_QWEN_SOURCE_FILE=~/.qwen/oauth_creds.json
CLIPROXYAPI_QWEN_TARGET_FILE=qwen-cli.json
CLIPROXYAPI_QWEN_EMAIL=qwen-cli
CLIPROXYAPI_QWEN_AUTH_MODE=auto
CLIPROXYAPI_OAUTH_NO_BROWSER=false
CLIPROXYAPI_ANTIGRAVITY_CALLBACK_PORT=51121
CLIPROXYAPI_CODEX_CALLBACK_PORT=1455
CLIPROXYAPI_QWEN_CALLBACK_PORT=0
CLIPROXYAPI_KIMI_CALLBACK_PORT=0

# Optional explicit base URLs used by cli-proxy-api.sh.
OPENWEBUI_URL=http://localhost:3000
VLLM_URL=http://localhost:8000

# ==============================================================================
# RAG (Retrieval-Augmented Generation) Settings
# ==============================================================================
# Embedding model for vectorizing documents
# Popular options:
# - sentence-transformers/all-MiniLM-L6-v2 (fast, lightweight)
# - sentence-transformers/all-mpnet-base-v2 (better quality, slower)
# - BAAI/bge-small-en-v1.5 (good quality)
# - BAAI/bge-base-en-v1.5 (better quality)
RAG_EMBEDDING_MODEL=sentence-transformers/all-MiniLM-L6-v2

# Number of document chunks to retrieve for context
RAG_TOP_K=5

# Include RAG context in system prompt
RAG_SYSTEM_CONTEXT=true

# Document chunking parameters
# Size of text chunks for document processing (in characters)
CHUNK_SIZE=1500

# Overlap between adjacent chunks (in characters)
CHUNK_OVERLAP=150

# Vector database backend
# Options: chroma (default), faiss
VECTOR_DB=chroma

# ==============================================================================
# Advanced RAG Settings
# ==============================================================================
# Web Search (SearXNG)
# OpenWebUI web search uses:
# - ENABLE_WEBSEARCH / WEBSEARCH_ENGINE / SEARXNG_QUERY_URL
# - WEB_SEARCH_RESULT_COUNT / WEB_SEARCH_CONCURRENT_REQUESTS
#
# This repo runs SearXNG on the host (not in docker compose). For OpenWebUI to use it,
# Docker must be able to reach the host on port 8888 from inside the container.
ENABLE_WEB_SEARCH=false
ENABLE_WEBSEARCH=false
WEB_SEARCH_ENGINE=searxng
WEBSEARCH_ENGINE=searxng
WEB_SEARCH_RESULT_COUNT=3
WEB_SEARCH_CONCURRENT_REQUESTS=10
SEARXNG_QUERY_URL=http://host.docker.internal:8888/search?q={query}&format=json

# ==============================================================================
# Additional Optional Settings
# ==============================================================================
# Enable debug logging
# DEBUG=false

# Maximum upload size for files (in MB)
# MAX_UPLOAD_SIZE=100

# Enable image generation support
# ENABLE_IMAGE_GENERATION=false

# Default theme
# THEME=dark
